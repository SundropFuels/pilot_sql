-- --------------------------------------------- --
-- Create analysis view from LV data and MS data --
-- --------------------------------------------- --
USE pilot_run_db;

DROP VIEW IF EXISTS analysis_view;

CREATE VIEW analysis_view AS
SELECT
  lv_data_tbl.ts AS ts
  lv_data_tbl.AG_1407_FAULT AS fault_roto_feed,
  lv_data_tbl.AG_1407_OP AS roto_feed_op,
  lv_data_tbl.AI_922021 AS ai_lock_hopper_purge,
  lv_data_tbl.AI_932050 AS ai_outlet_moisture,
  lv_data_tbl.DPI_922019 AS dp_feeder_inlet,
  lv_data_tbl.DPI_922021 AS dp_gasifier,
  lv_data_tbl.DPI_922022 AS dp_inlet_bell,
  lv_data_tbl.DPI_932014 AS dp_exit_quench,
  lv_data_tbl.DPI_932015 AS dp_quench_candle,
  lv_data_tbl.DPI_932070 AS dp_quench_ako,
  lv_data_tbl.DPI_932071 AS dp_ako_ambient,
  lv_data_tbl.DPI_932302 AS dp_bag_purge,
  lv_data_tbl.DPI_936014 AS dp_quench_candle_hopper,
  lv_data_tbl.DPI_936015 AS dp_candle_ko_ambient,
  lv_data_tbl.DPIT_922007 AS dp_1403_1402,
  lv_data_tbl.E_STOP AS e_stop,
  lv_data_tbl.FI_1423 AS mass_flow_supply_4,
  lv_data_tbl.FI_1445 AS mass_flow_supply_5,
  lv_data_tbl.FI_932006 AS mass_flow_quench,
  lv_data_tbl.FI_932036 AS flow_coriolis,
  lv_data_tbl.FIC_1442_OP AS mass_flow_entrainment_op,
  lv_data_tbl.FIC_1442_PV  AS mass_flow_entrainment,
  lv_data_tbl.FIC_1442_SP AS mass_flow_entrainment_sp,
  lv_data_tbl.FIC_983006_OP AS mass_flow_steam_op,
  lv_data_tbl.FIC_983006_PV AS mass_flow_steam,
  lv_data_tbl.FIC_983006_SP AS mass_flow_steam_sp,
  lv_data_tbl.FIC_986009_OP AS mass_flow_superheater_op,
  lv_data_tbl.FIC_986009_PV AS mass_flow_superheater_purge,
  lv_data_tbl.FIC_986009_SP AS mass_flow_superheater_purge_sp,
  lv_data_tbl.FIC_989011_PV AS mass_flow_sweep,
  lv_data_tbl.FIC_989011_SP AS mass_flow_sweep_sp,
  lv_data_tbl.FIC_990014_PV AS mass_flow_argon,
  lv_data_tbl.FIC_990014_SP AS mass_flow_argon_sp,
  lv_data_tbl.HS_932018 AS valve_ako_inlet_actuator,
  lv_data_tbl.HS_932025 AS valve_ako_outlet_actuator,
  lv_data_tbl.LCV_932024 AS valve_water_fill,
  lv_data_tbl.LE_932004 AS level_water,
  lv_data_tbl.LSH_1405 AS switch_level_water_high,
  lv_data_tbl.LSH_932021 AS switch_ako_level_high,
  lv_data_tbl.LSL_1406 AS switch_1406_low,
  lv_data_tbl.PC_983001 AS pressure_boiler_sp,
  lv_data_tbl.PCV_1420_OP AS pressure_entrainment_op,
  lv_data_tbl.PCV_1420_PV AS pressure_entrainment,
  lv_data_tbl.PCV_1420_SP AS pressure_entrainment_sp,
  lv_data_tbl.PDI_1445 AS dp_lock_hopper_injector,
  lv_data_tbl.PI_1442 AS pressure_roto_feed_injector_inlet,
  lv_data_tbl.PI_1445 AS pressure_lock_hopper_supply,
  lv_data_tbl.PI_326 AS pressure_furnace_2,
  lv_data_tbl.PI_924502 AS pressure_bell_housing,
  lv_data_tbl.PI_924XXX AS pressure_furnace_1,
  lv_data_tbl.PI_932019 AS pressure_ako,
  lv_data_tbl.PI_932042 AS pressure_purge_gas_filter,
  lv_data_tbl.PI_932057 AS pressure_ms_inlet,
  lv_data_tbl.PI_932503 AS pressure_backup_quench_inlet,
  lv_data_tbl.PI_936010 AS pressure_candle_filter_outlet,
  lv_data_tbl.PI_936012 AS pressure_candle_filter_backpulse,
  lv_data_tbl.PI_936052 AS pressure_candle_filter_ko,
  lv_data_tbl.PI_983003 AS pressure_boiler ,
  lv_data_tbl.PI_983005 AS pressure_boiler_exit,
  lv_data_tbl.PIC_932005_OP AS pressure_quench_op,
  lv_data_tbl.PIC_932005_PV AS pressure_quench,
  lv_data_tbl.PIC_932005_SP AS pressure_quench_sp,
  lv_data_tbl.PIC_932030_OP AS pressure_outlet_op,
  lv_data_tbl.PIC_932030_PV AS pressure_outlet,
  lv_data_tbl.PIC_932030_SP AS pressure_outlet_sp,
  lv_data_tbl.PS_1404 AS switch_bladder_1404_inflation,
  lv_data_tbl.PS_1405 AS switch_bladder_1405_inflation,
  lv_data_tbl.PS_1406 AS switch_bladder_lower_inflation,
  lv_data_tbl.PS_932044 AS switch_bladder_purge_filter_inflation,
  lv_data_tbl.PSL_986611 AS switch_ms_containment_pressure_low,
  lv_data_tbl.PSL_986902 AS switch_analyzer_containment_pressure_low,
  lv_data_tbl.PT_1406 AS pressure_1405,
  lv_data_tbl.PT_922008/PT_1450 AS pressure_roto_feed_exit,
  lv_data_tbl.TE_922022 AS temp_ako_relief,
  lv_data_tbl.TE_932016 AS temp_quench_exit_relief,
  lv_data_tbl.TE_983301 AS temp_superheater_2_shell,
  lv_data_tbl.TE_983302 AS temp_superheater_2_element,
  lv_data_tbl.TE_983303 AS temp_superheater_1_shell,
  lv_data_tbl.TE_983304 AS temp_superheater_1_element,
  lv_data_tbl.TE_983305 AS temp_superheater_interstage,
  lv_data_tbl.TI_323 AS temp_gasifier_stack_inlet,
  lv_data_tbl.TI_324A AS temp_gasifier_refractory_2,
  lv_data_tbl.TI_324B AS temp_gasifier_refactory_1,
  lv_data_tbl.TI_922020 AS temp_biomass_inlet_skin,
  lv_data_tbl.TI_924001 AS temp_upper_bucket_seal_skin,
  lv_data_tbl.TI_924002 AS temp_lower_bucket_seal_skin,
  lv_data_tbl.TI_924003 AS temp_gasifier_exit,
  lv_data_tbl.TI_924004 AS temp_expansion_joint_skin,
  lv_data_tbl.TI_924012 AS temp_skin_tube_top,
  lv_data_tbl.TI_924013 AS temp_skin_tube_middle,
  lv_data_tbl.TI_924014 AS temp_skin_tube_bottom,
  lv_data_tbl.TI_924032 AS temp_upper_bucket_seal_containment_skin,
  lv_data_tbl.TI_924034 AS temp_lower_bucket_seal_containment_skin,
  lv_data_tbl.TI_924036 AS temp_gasifier_exit_spool_skin,
  lv_data_tbl.TI_924101 AS temp_gasifier_stack_outlet,
  lv_data_tbl.TI_924503 AS temp_tar_cooler_skin,
  lv_data_tbl.TI_932001 AS temp_quench_skin,
  lv_data_tbl.TI_932003 AS temp_quench_lower,
  lv_data_tbl.TI_932007A AS temp_quench_exit ,
  lv_data_tbl.TI_932007B AS temp_quench_exit_redundant,
  lv_data_tbl.TI_932011 AS temp_primary_quench_inlet,
  lv_data_tbl.TI_932017 AS temp_quench_pressure_relief_exit,
  lv_data_tbl.TI_932018 AS temp_quench_exit_valve_skin,
  lv_data_tbl.TI_932023 AS temp_ako_outlet_valve_skin,
  lv_data_tbl.TI_932035 AS temp_coriolis_before,
  lv_data_tbl.TI_932051 AS temp_tar_filter_exit,
  lv_data_tbl.TI_932056 AS temp_ms_inlet,
  lv_data_tbl.TI_932101 AS temp_ako_gas,
  lv_data_tbl.TI_932151 AS temp_tar_probe_vent,
  lv_data_tbl.TI_932152 AS temp_gc_vent,
  lv_data_tbl.TI_932501 AS temp_primary_quench_water,
  lv_data_tbl.TI_932502 AS temp_backup_quench_return,
  lv_data_tbl.TI_936001 AS temp_candle_filter_inlet,
  lv_data_tbl.TI_936002 AS temp_candle_filter_1,
  lv_data_tbl.TI_936003 AS temp_candle_filter_2,
  lv_data_tbl.TI_936004 AS temp_candle_filter_3,
  lv_data_tbl.TI_936005 AS temp_candle_filter_4,
  lv_data_tbl.TI_936006 AS temp_candle_filter_5,
  lv_data_tbl.TI_936007 AS temp_candle_filter_outlet,
  lv_data_tbl.TI_936008 AS temp_candle_filter_ash_dump,
  lv_data_tbl.TI_936009 AS temp_candle_filter_backpulse,
  lv_data_tbl.TI_936102 AS temp_candle_filter_outlet_purge,
  lv_data_tbl.TI_983004 AS temp_boiler,
  lv_data_tbl.TI_983013 AS temp_steam_relief_vent,
  lv_data_tbl.TI_983027 AS temp_steam_superheater_exit,
  lv_data_tbl.TI_983036 AS temp_steam_gasifier_inlet,
  lv_data_tbl.TI_986065 AS temp_car_cooling_exit,
  lv_data_tbl.TI_989015 AS temp_bell_sweep_inlet,
  lv_data_tbl.TIC_932007_OP AS temp_quench_op,
  lv_data_tbl.TIC_932007_PV AS temp_quench,
  lv_data_tbl.TIC_932007_SP AS temp_quench_sp,
  lv_data_tbl.TIC_932053_OP AS temp_tar_probe_heat_trace_op,
  lv_data_tbl.TIC_932053_PV AS temp_tar_probe_heat_trace,
  lv_data_tbl.TIC_932053_SP AS temp_tar_probe_heat_trace_sp,
  lv_data_tbl.TIC_986610_OP AS temp_ms_heat_trace_op,
  lv_data_tbl.TIC_986610_PV AS temp_ms_heat_trace,
  lv_data_tbl.TIC_986610_SP AS temp_mv_heat_trace_sp,
  lv_data_tbl.TY_924021_SP AS temp_furnace_sp,
  lv_data_tbl.TY_983014_SP AS temp_superheater_sp,
  lv_data_tbl.WIC_1402_PV AS valve_feed_auger_pv,
  lv_data_tbl.WIT_1406 AS mass_feed_vessel,
  lv_data_tbl.XV_1401 AS valve_feed_hopper_filter_purge,
  lv_data_tbl.XV_1404 AS valve_top_lock_inlet,
  lv_data_tbl.XV_1405 AS valve_inter_feed,
  lv_data_tbl.XV_1406 AS valve_bottom_lock_outlet,
  lv_data_tbl.XV_1421 AS valve_injector,
  lv_data_tbl.XV_1422 AS valve_supply_3,
  lv_data_tbl.XV_1423 AS valve_supply_4,
  lv_data_tbl.XV_1440 AS valve_injector_2,
  lv_data_tbl.XV_1441 AS valve_injector_1,
  lv_data_tbl.XV_1443 AS valve_pressurization,
  lv_data_tbl.XV_1444 AS valve_isolating_flex,
  lv_data_tbl.XV_1445 AS valve_supply_5,
  lv_data_tbl.XV_1447 AS valve_purge,
  lv_data_tbl.XV_1448A AS valve_purge_1,
  lv_data_tbl.XV_1448B AS valve_purge_2,
  lv_data_tbl.XV_1449A AS valve_vent_1,
  lv_data_tbl.XV_1449B AS valve_vent_2,
  lv_data_tbl.XV_1449C AS valve_vent_bleed,
  lv_data_tbl.XV_1450 AS valve_feed_entrainment,
  lv_data_tbl.XV_922016 AS valve_biomass_inlet,
  lv_data_tbl.XV_932018 AS valve_quench_exit,
  lv_data_tbl.XV_932025 AS valve_ako_outlet,
  lv_data_tbl.XV_932028 AS valve_oxidizer_purge,
  lv_data_tbl.XV_932046 AS valve_purge_filter,
  lv_data_tbl.XV_932049 AS valve_quench_backup,
  lv_data_tbl.XV_932052 AS valve_tar_probe,
  lv_data_tbl.XV_932180 AS valve_quench_isolation,
  lv_data_tbl.XV_932301A AS valve_filter_backpulse_a,
  lv_data_tbl.XV_932301B AS valve_filter_backpulse_b,
  lv_data_tbl.XV_932301C AS valve_filter_backpulse_c,
  lv_data_tbl.XV_932504 AS valve_ako_outlet_shutoff,
  lv_data_tbl.XV_932505 AS valve_quench_exit_top,
  lv_data_tbl.XV_936001A AS valve_candle_filter_exit_a,
  lv_data_tbl.XV_936001B AS valve_candle_filter_exit_b,
  lv_data_tbl.XV_936002A AS valve_candle_filter_ko_exit_a,
  lv_data_tbl.XV_936002B AS valve_candle_filter_ko_exit_b,
  lv_data_tbl.XV_936050 AS valve_candle_filter_hopper_purge,
  lv_data_tbl.XV_936058 AS valve_candle_filter_outlet_purge,
  lv_data_tbl.XV_936080 AS valve_candle_filter_purge_supply,
  lv_data_tbl.XV_983012 AS valve_steam_vent,
  lv_data_tbl.XV_983013 AS valve_steam_shutoff,
  lv_data_tbl.XV_983065 AS valve_tar_probe_steam,
  lv_data_tbl.XV_986006 AS valve_steam_superheater_purge,
  lv_data_tbl.XV_986016 AS valve_ako_purge_filter,
  lv_data_tbl.XV_986024 AS valve_ako_purge,
  lv_data_tbl.XV_986034 AS valve_purge_filter_supply,
  lv_data_tbl.XV_986901 AS valve_tar_probe_purge,
  lv_data_tbl.XV_989012 AS valve_sweep,
  lv_data_tbl.XV_990013 AS valve_argon,
  lv_data_tbl.ZSC_922016 AS switch_biomass_inlet_closed,
  lv_data_tbl.ZSC_932504 AS switch_ako_outlet_closed,
  lv_data_tbl.ZSC_932505 AS switch_quench_exit_closed,
  lv_data_tbl.ZSC_936001A AS switch_candle_filter_exit_a_closed,
  lv_data_tbl.ZSC_936001B AS switch_candle_filter_exit_b_closed,
  lv_data_tbl.ZSC_936002A AS switch_candle_filter_ko_a_closed,
  lv_data_tbl.ZSC_936002B AS switch_candle_filter_ko_b_closed,
  lv_data_tbl.ZSC_983012 AS switch_steam_vent_closed,
  lv_data_tbl.ZSC_983013 AS switch_steam_shutoff_closed,
  lv_data_tbl.ZSO_922016 AS switch_biomass_inlet_open,
  lv_data_tbl.ZSO_983012 AS switch_steam_vent_open,
  lv_data_tbl.ZSO_983013 AS switch_steam_shutoff_open
  FROM lv_data_tbl LEFT JOIN
  ms_data_tbl ON
  lv_data_tbl.ts = ms_data_tbl.ts;
